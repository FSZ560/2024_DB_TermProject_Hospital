## 系統功能介紹
此網站為醫院資訊管理系統，提供院內人員管理病患基本資料、門診、醫護人員、病歷及診斷書等功能，同時也開放民眾查詢門診時段及進行網路掛號服務。

<!-- The SQL code here is based on MariaDB -->

## SQL DDL

* 人類

```sql
CREATE TABLE person (
    person_id CHAR(7),
    last_name VARCHAR(20) NOT NULL,
    first_name VARCHAR(20) NOT NULL,
    phone VARCHAR(20) NOT NULL,
    id_card CHAR(10) NOT NULL,
    address VARCHAR(100) NOT NULL, 
    gender CHAR(1) NOT NULL,
    birthday DATE NOT NULL,
    PRIMARY KEY (person_id)
);
```

| person_id | last_name | first_name | phone | id_card | address | gender | birthday |
|-----------|-----------|------------|-------|---------|---------|--------|----------|
| P000001 | Wong | Xiaoming | 0935465482 | F123456789 | 新北市金山區中華路5號 | M | 1999/02/24 |
| P000002 | Tsai | Xiaofang | 0943542477 | K281651723 | 苗栗縣苗栗市太平街32號 | F | 2001/07/04 |
| P000003 | Wu | Xiaowong | 0911284347 | N164822313 | 彰化縣溪湖鎮福地二街19號 | M | 2000/12/29 |

[person_id]：紀錄登記人的ID，為Primary key  
[last_name]：紀錄登記人的姓  
[first_name]：紀錄登記人的名  
[phone]：紀錄登記人的電話號碼  
[id_card]：紀錄登記人的身分證  
[address]：紀錄登記人的地址  
[gender]：紀錄登記人的性別  
[birthday]：紀錄登記人的生日  

* 科別

```sql
CREATE TABLE department (
    department_id CHAR(7),
    department_name VARCHAR(50) NOT NULL,
    PRIMARY KEY (department_id)
);
```

| department_id | department_name |
|---------------|-----------------|
| D000001 | Dentistry |
| D000002 | Ophthalmology |
| D000003 | Pediatrics |

[department_id]：紀錄科別的ID，為Primary key  
[department_name]：紀錄科別的名稱  

* 病患資料

```sql
CREATE TABLE patient (
    person_id CHAR(7),
    height DECIMAL(5,2) NOT NULL,
    weight DECIMAL(5,2) NOT NULL,
    PRIMARY KEY (person_id),
    FOREIGN KEY (person_id) REFERENCES person(person_id)
);
```

| person_id | height | weight |
|-----------|--------|--------|
| P000001 | 175.20 | 76.70 |
| P000002 | 168.40 | 60.20 |
| P000003 | 173.80 | 62.90 |

[person_id]：紀錄登記人的ID，為Primary key，同時也是Foreign key對應到person的person_id  
[height]：紀錄登記人的身高  
[weight]：紀錄登記人的體重  

* 員工資料

```sql
CREATE TABLE staff (
    person_id CHAR(7),
    department_id CHAR(7) NOT NULL,
    status VARCHAR(50) NOT NULL,
    salary INT NOT NULL,
    PRIMARY KEY (person_id),
    FOREIGN KEY (person_id) REFERENCES person(person_id),
    FOREIGN KEY (department_id) REFERENCES department(department_id)
);
```

| person_id | department_id | status | salary |
|-----------|---------------|--------|--------|
| P100001 | D000001 | dean | 600000 |
| P100002 | D000003 | director | 200000 |
| P100003 | D000002 | doctor | 150000 |

[person_id]：紀錄登記人的ID，為Primary key，同時也是Foreign key對應到person的person_id  
[department_id]：紀錄科別的ID，為Foreign key對應到department的department_id  
[status]：紀錄登記人的身分地位  
[salary]：紀錄登記人的薪水  

* 門診

```sql
CREATE TABLE clinic (
    clinic_id CHAR(7),
    clinic_date DATE NOT NULL,
    period SET('morning', 'afternoon', 'evening') NOT NULL,
    department_id CHAR(7) NOT NULL,
    location VARCHAR(100) NOT NULL,
    doctor_id CHAR(7) NOT NULL,
    PRIMARY KEY (clinic_id),
    FOREIGN KEY (department_id) REFERENCES department(department_id),
    FOREIGN KEY (doctor_id) REFERENCES staff(person_id)
);
```

| clinic_id | clinic_date | period | department_id | location | doctor_id |
|-----------|-------------|--------|---------------|----------|-----------|
| C000001 | Monday to Saturday | morning, aftermoon, evening | D000003 | 臺南市仁德區仁德五街19號 | M000002 |
| C000002 | Sunday to Friday | morning, aftermoon, eveningg | D000002 | 臺中市大甲區順帆北路12號 | M000003 |
| C000003 | everyday | morning, aftermoon | D000001 | 新北市樹林區三多路18號 | M000001 |

[clinic_id]：紀錄門診的ID，為Primary key  
[clinic_date]：紀錄門診營業的日期  
[period]：紀錄門診營業的時段(早中晚)  
[department_id]：紀錄科別的ID，為Foreign key對應到department的department_id  
[location]：紀錄門診的地點  
[doctor_id]：紀錄醫生的ID，為Foreign key對應到staff的person_id  

* 病人門診紀錄

```sql
CREATE TABLE medical_records (
    records_id CHAR(7),
    patient_id CHAR(7) NOT NULL,
    clinic_id CHAR(7) NOT NULL,
    PRIMARY KEY (records_id),
    FOREIGN KEY (patient_id) REFERENCES patient(person_id),
    FOREIGN KEY (clinic_id) REFERENCES clinic(clinic_id)
);
```

| records_id | patient_id | clinic_id |
|------------|------------|-----------|
| R000001 | P000002 | C000003 |
| R000002 | P000001 | C000001 |
| R000003 | P000003 | C000002 |

[records_id]：紀錄門診紀錄的ID，為Primary key  
[patient_id]：紀錄患者的ID，為Foreign key對應到patient的person_id  
[clinic_id]：紀錄門診的ID，為Foreign key對應到clinic的clinic_id  

* 診斷書  

```sql
CREATE TABLE medical_certificate (
    certificate_id CHAR(7),
    records_id CHAR(7) NOT NULL UNIQUE,
    prescription TEXT NOT NULL,
    PRIMARY KEY (certificate_id),
    FOREIGN KEY (records_id) REFERENCES medical_records (records_id)
);
```

| certificate_id | records_id | prescription |
|----------------|------------|--------------|
| C000001 | R000003 | 黃斑部病變 |
| C000002 | R000002 | 牙周病 |
| C000003 | R000001 | 腦膜炎 |

[certificate_id]：紀錄診斷書的ID，為Primary key  
[records_id]：紀錄門診紀錄的ID，為Foreign key對應到medical_records的records_id  
[prescription]：紀錄診斷結果  

* 掛號資訊  

```sql
CREATE TABLE appointment (
    appointment_id CHAR(7),
    sequence_no INT AUTO_INCREMENT,
    clinic_id CHAR(7) NOT NULL,
    patient_id CHAR(7) NOT NULL,
    register_time DATETIME NOT NULL,
    PRIMARY KEY (appointment_id),
    FOREIGN KEY (clinic_id) REFERENCES clinic(clinic_id),
    FOREIGN KEY (patient_id) REFERENCES patient(person_id)
);
```

| appointment_id | sequence_no | clinic_id | patient_id | register_time |
|----------------|-------------|-----------|------------|---------------|
| A000001 | S000012 | C000003 | P000012 | 2024/11/09 15:30 |
| A000002 | S000014 | C000001 | P000018 | 2024/11/09 16:00 |
| A000003 | S000015 | C000002 | P000021 | 2024/11/10 18:00 |

[appointment_id]：紀錄預約掛號的ID，為Primary key  
[sequence_no]：紀錄掛號順序的號碼  
[clinic_id]：紀錄門診的ID，為Foreign key對應到clinic的clinic_id  
[patient_id]：紀錄患者的ID，為Foreign key對應到patient的person_id  
[register_time]：紀錄預約看診的時間並儲存  

## SQL DML (insert, delete, alter, ...)

- 新增一個人的基本資料

    ```sql
    INSERT INTO person (person_id, last_name, first_name, phone, id_card, address, gender, birthday)
    VALUES ('P000001', '王', '小明', '0912345678', 'A123456789', '台北市信義區信義路100號', 'M', '1990-01-01');
    ```

- 新增一個門診掛號

    ```sql
    INSERT INTO appointment (appointment_id, clinic_id, patient_id, register_time)
    VALUES ('A000001', 'C000001', 'P000001', NOW());
    ```

- 刪除某個門診掛號

    ```sql
    DELETE FROM appointment 
    WHERE appointment_id = 'A000001';
    ```

- 更新某個人的聯絡資料

    ```sql
    UPDATE person 
    SET phone = '0987654321'
    WHERE person_id = 'P000001';
    ```

- 顯示人員列表

    ```sql
    SELECT *
    FROM person;
    ```

- 計算每個科別的員工數

    ```sql
    SELECT d.department_name, COUNT(s.person_id) AS employee_count
    FROM department d
    LEFT OUTER JOIN staff s ON d.department_id = s.department_id
    GROUP BY d.department_id, d.department_name;
    ```

- 查詢今日各門診的掛號人數

    ```sql
    SELECT c.clinic_id, d.department_name, c.period, COUNT(a.appointment_id) AS appointment_count
    FROM clinic c
    JOIN department d ON c.department_id = d.department_id
    LEFT JOIN appointment a ON c.clinic_id = a.clinic_id
    WHERE c.clinic_date = CURRENT_DATE
    GROUP BY c.clinic_id, d.department_name, c.period;
    ```

## 網站架構

![website_branch_pic](/WebsiteBranchPic.png "website_branch_pic")

## 初步畫面設計



## 工作分配

巫:
黃:
任:
